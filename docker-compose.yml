# =============================================================================
# stock-bot — docker-compose for Portainer stack deployment
# =============================================================================
# This runs stock-bot, which sends portfolio reports via Telegram.
#
# QUICK START (test message):
#   1. Create a Telegram bot via @BotFather → copy the token
#   2. Get your chat_id (send /start to your bot, then visit
#      https://api.telegram.org/bot<TOKEN>/getUpdates)
#   3. Copy .env.example → .env and fill in TELEGRAM_BOT_TOKEN + TELEGRAM_CHAT_ID
#   4. docker compose run --rm -e RUN_ONCE=true stock-bot
#   5. docker compose up -d    ← starts the scheduled bot
# =============================================================================

services:
  stock-bot:
    build:
      context: .
      dockerfile: Dockerfile
    image: stock-bot:latest
    container_name: stock-bot
    restart: unless-stopped
    environment:
      - TELEGRAM_BOT_TOKEN=${TELEGRAM_BOT_TOKEN}
      - TELEGRAM_CHAT_ID=${TELEGRAM_CHAT_ID:-}
      - RUN_ONCE=${RUN_ONCE:-false}
      - LOG_LEVEL=${LOG_LEVEL:-INFO}
      - FINNHUB_API_KEY=${FINNHUB_API_KEY:-}
      - ALPHAVANTAGE_API_KEY=${ALPHAVANTAGE_API_KEY:-}
    volumes:
      - ./config.yml:/app/config.yml:ro
